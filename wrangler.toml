name = "abateiq"
main = "server/worker.ts"
compatibility_date = "2026-02-06"

routes = [
  # Use Workers Routes (not Custom Domains) so we can route all paths (/*) without Custom Domain restrictions.
  { pattern = "abateiq.com/*", zone_name = "abateiq.com" },
  { pattern = "www.abateiq.com/*", zone_name = "abateiq.com" }
]

[assets]
directory = "./dist/public"

[vars]
# Cloudflare Access (internal-only auth)
# Set these in the Cloudflare Dashboard or via `wrangler secret put` / `wrangler deploy --var ...`
# CF_ACCESS_TEAM_DOMAIN example: "your-team.cloudflareaccess.com"
# CF_ACCESS_AUD example: (the AUD shown on your Access Application)
CF_ACCESS_TEAM_DOMAIN = ""
CF_ACCESS_AUD = ""
# Local dev bypass: set to an email to skip Access locally (do not set in production)
DEV_AUTH_EMAIL = ""

NEON_AUTH_URL = "https://ep-square-shape-ain65e34.neonauth.c-4.us-east-1.aws.neon.tech/neondb/auth"
NEON_JWKS_URL = "https://ep-square-shape-ain65e34.neonauth.c-4.us-east-1.aws.neon.tech/neondb/auth/.well-known/jwks.json"
NEON_JWT_ISSUER = "https://ep-square-shape-ain65e34.neonauth.c-4.us-east-1.aws.neon.tech"
NEON_JWT_AUDIENCE = "https://ep-square-shape-ain65e34.neonauth.c-4.us-east-1.aws.neon.tech"
ADMIN_EMAILS = "larkinjason@icloud.com,jlarkin@bierlein.com"

[[r2_buckets]]
binding = "ABATEIQ_UPLOADS"
bucket_name = "abateiq-uploads"

[[d1_databases]]
binding = "DB"
database_name = "abateiq"
database_id = "80d077ef-36ef-4d59-b404-15cf040d5911"

[observability.logs]
enabled = false
invocation_logs = true
